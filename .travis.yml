language: android
jdk: oraclejdk8

android:
  components:
    - platform-tools
    - tools
    - build-tools-25.0.2
    - android-25

    - extra-android-m2repository

branches:
  only:
    - "master"

before_install:
  - chmod +x gradlew
  - chmod -R +x scripts
  - mkdir "$ANDROID_HOME/licenses" || true
  - echo -e "\n8933bad161af4178b1185d1a37fbf41ea5269c55" > "$ANDROID_HOME/licenses/android-sdk-license"
  - echo -e "\n84831b9409646a918e30573bab4c9c91346d8abd" > "$ANDROID_HOME/licenses/android-sdk-preview-license"
  - openssl aes-256-cbc -K $encrypted_66f3293bf931_key -iv $encrypted_66f3293bf931_iv -in key.p12.enc -out key.p12 -d
  - openssl aes-256-cbc -K $encrypted_1f32612fea61_key -iv $encrypted_1f32612fea61_iv -in keystore-upload.jks.enc -out keystore-upload.jks -d

script: ./scripts/play-publish-if-not-pr.sh

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
    - $HOME/.android/build-cache

env:
  global:
    - secure: "pktDyeZRS8X1GgvnBlxGoo72FlDUeHNVnoscfZyLA34z0XfMeW8KZ9eZU3Hs0YHmT3GDz0t3qutZc+tJCMk0fdLprAJ5bHSdEZ47/XLu9aJmr4pf6HvGrPd6GzZR5WYYLfdGueuRI3+eXEb7D3eQ1uRUcDYzb5xgRDRFrlfWf8Xj8DyZjFBY/hIAVNPiHGUSeXrdSYxSbGWq9lw9FM7U2Sh2XZOcuxmBX+oMlx8isTlqKQ6oMwgKLH88LycUVfhUMLkGcJqwSYIwtjXywUyrLSJTUIbtUjd3R7XRvdJO0sZpjQVGN4E+jVno8/EXxqWm3kwrpgSiVt1KCTu9yKqzgGMFYe7wZzJvMUBG/NoUwk9xQcbed63nXqqMgHseZUNrkAAMhe8ZjHkzsU898rdcjX3ljiSGpFBQjk7r2iyP+cjg0/yYnXLgC1Fyv6SZ2Tzw1UWYGgGszySjOstvpOs5wfH73TyY8K5wbqYylKcgaEAHDoDaar5sD5khVqAtAVNCz0SIRIO9TAvGbpuaMfbYfLHkjXj1Ad/Fp05LqoVCsgVO/0kpOm+YFPAQGEj/6C313OOCMOqRpZJp4OHIG/z7ef/F/NGTE4s+40daO8JrgMSeh+GibxRQnI/jL3JWqPpTOdQfQPWV4/CG2cXPsllGsNAqutoJMbSQJ0hFxq09+BE="
    - secure: "JbiGmln6dnl9vqb5xnb2b7lEiFdP+PT39SKEPp/Yl/aSlGfzWyMLep05QWbcBYRqV7VvY1NkiNMlx4vm3RNLA6Qt0bqbQNbInSFY+b6HOLmUdT3iFvfupOb3nrTx6HQemXkeeBwmZWj5w4LrXcezquWSgS5HCS/Q+rd3JaMV+oySIvhdo0kO9XZAgPljR4oKg8pMukZZTgeCZ2LF1uaVrBmbpfzyObQ1j1hfb/FYmTBPKLemp0yjA+rtRQJivDOEPzRTDmNFKmhe6XWR47JhgDC/lPNq20KdfsEKRO4CxGrTdQe0dn7BRXAe63gsmhEgvJaaieAUGSWnv7t26Yi9dmxt8x/807Q6iMFl88mF8lJnC+a6MRC+IEJp6kLQP7aDs+zY5n1A7S38dbBouy1RoYNHo2UZXodYw9oXat6IaNJcbMeg6ty8dALqD/bNMVEyx8KXTq6prXQiomTSwyItuby42s8PcmAMumCnLjWC53W5Hkq47V7GGQR9WU8wQtuhQB7UIvvRfHbKKGC9+5Rxskr2nnKJu8AFLxdEl9AUXJ+Y08DvxCGJYqK5btDXiACPdyEy+gQ2f0lrh0SgLPPewxAo07OvoJZkNpnFnHcByHtQa/vVMY5dTqfhiwu374mUa9N6MNRBgIYMTpmXKx98exYByHkDx1wbKNTk7P65I40="

notifications:
   slack: prenium:2gTwarksU0EirBAFHy56dj6j